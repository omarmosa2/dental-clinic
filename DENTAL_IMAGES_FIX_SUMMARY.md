# ููุฎุต ุฅุตูุงุญ ูุธุงู ุงูุตูุฑ ูู ุงูุชุทุจูู

## ุงููุดุงูู ุงูุชู ุชู ุฅุตูุงุญูุง:

### 1. ุชุถุงุฑุจ ูู Electron API
**ุงููุดููุฉ**: ูุงู ููุงู ุชุถุงุฑุจ ุจูู ูููุงุช main.js ู main.ts ููุฐูู preload.js ู preload.ts ูู ุฏูุงู ุฑูุน ุงูุตูุฑ.

**ุงูุญู**:
- ุชู ุชูุญูุฏ ุฏุงูุฉ `uploadDentalImage` ูุชุฃุฎุฐ 7 ูุนุงููุงุช: `(fileBuffer, fileName, patientId, toothNumber, imageType, patientName, toothName)`
- ุชู ุชูุญูุฏ ุฏุงูุฉ `saveDentalImage` ุจููุณ ุงููุนุงููุงุช
- ุชู ุฅุถุงูุฉ ุฏูุงู `getDentalImage` ู `checkImageExists` ูู main.ts

### 2. ุชูุธูู ูุณุงุฑุงุช ุงูุตูุฑ
**ุงููุดููุฉ**: ูุงูุช ุงูุตูุฑ ุชูุญูุธ ูู ูุณุงุฑุงุช ูุฎุชููุฉ ูุบูุฑ ูุชูุงุณูุฉ.

**ุงูุญู ุงูุฌุฏูุฏ**:
```
dental_images/
โโโ ุงุณู_ุงููุฑูุถ/
โ   โโโ before/
โ   โ   โโโ ุงุณู_ุงูุณู-timestamp.jpg
โ   โโโ after/
โ   โ   โโโ ุงุณู_ุงูุณู-timestamp.jpg
โ   โโโ xray/
โ   โ   โโโ ุงุณู_ุงูุณู-timestamp.jpg
โ   โโโ clinical/
โ       โโโ ุงุณู_ุงูุณู-timestamp.jpg
```

### 3. ุญุฐู ุงูุตูุฑ
**ุงููุดููุฉ**: ุญุฐู ุงูุตูุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุง ูุญุฐู ุงูููู ุงููุนูู.

**ุงูุญู**:
- ุชู ุชุญุฏูุซ ุฏุงูุฉ `db:dentalTreatmentImages:delete` ูุชุญุฐู ุงูููู ุงููุนูู ุฃููุงู ุซู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชู ุฅุถุงูุฉ ุงูุจุญุซ ูู ูุณุงุฑุงุช ูุชุนุฏุฏุฉ ููุนุซูุฑ ุนูู ุงูููู

### 4. ูุงุนุฏุฉ ุงูุจูุงูุงุช
**ุงููุดููุฉ**: ุฌุฏูู `dental_treatment_images` ูู ููู ูุญุชูู ุนูู ุฌููุน ุงูุฃุนูุฏุฉ ุงููุทููุจุฉ.

**ุงูุญู**:
- ุชู ุฅุถุงูุฉ ุงูุฃุนูุฏุฉ ุงูููููุฏุฉ: `patient_id`, `tooth_number`, `taken_date`, `updated_at`
- ุชู ุชุญุฏูุซ ุฏูุงู ุฅูุดุงุก ุงูุตูุฑ ูุชุณุชุฎุฏู ุงูุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ

### 5. ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ
**ุงููุดููุฉ**: ุงุณุชุนุงุฏุฉ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ูุง ุชุชุนุงูู ูุน ุงููุณุงุฑุงุช ุงูุฌุฏูุฏุฉ ููุตูุฑ.

**ุงูุญู**:
- ุชู ุชุญุฏูุซ ุฏุงูุฉ `updateImagePathsAfterRestore` ูุชุณุชุฎุฏู ุงููุณุงุฑุงุช ุงูุฌุฏูุฏุฉ
- ุชู ุฅุถุงูุฉ ุงูุจุญุซ ุนู ุงุณู ุงููุฑูุถ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุจูุงุก ุงููุณุงุฑ ุงูุตุญูุญ

## ุงููููุงุช ุงููุญุฏุซุฉ:

### Electron Files:
1. `electron/main.js` - ุชู ุชุญุฏูุซ ุฏูุงู ุฑูุน ูุญุฐู ุงูุตูุฑ
2. `electron/main.ts` - ุชู ุชูุญูุฏ API ูุน main.js
3. `electron/preload.js` - ุชู ุชุญุฏูุซ ุงูุชูููุนุงุช
4. `electron/preload.ts` - ุชู ุชูุญูุฏ API ูุน preload.js

### Database Files:
1. `src/services/databaseService.js` - ุชู ุชุญุฏูุซ ุฌุฏูู dental_treatment_images

### Backup Files:
1. `src/services/backupService.js` - ุชู ุชุญุฏูุซ ุงุณุชุนุงุฏุฉ ุงูุตูุฑ

## ููููุฉ ุงุฎุชุจุงุฑ ุงูุฅุตูุงุญุงุช:

### 1. ุฅุถุงูุฉ ุตูุฑุฉ:
```
โ ุงุฐูุจ ุฅูู ูุฑูุถ
โ ุงุฎุชุฑ ุณู
โ ุฃุถู ุตูุฑุฉ (before/after/xray/clinical)
โ ุชุญูู ูู ุญูุธ ุงูุตูุฑุฉ ูู ุงููุณุงุฑ ุงูุตุญูุญ
```

### 2. ุนุฑุถ ุงูุตูุฑุฉ:
```
โ ุชุญูู ูู ุธููุฑ ุงูุตูุฑุฉ ูู ูุงุฌูุฉ ุงูุณู
โ ุชุญูู ูู ุฅููุงููุฉ ูุชุญ ุงูุตูุฑุฉ
```

### 3. ุญุฐู ุงูุตูุฑุฉ:
```
โ ุงุญุฐู ุงูุตูุฑุฉ ูู ูุงุฌูุฉ ุงูุณู
โ ุชุญูู ูู ุญุฐู ุงูููู ุงููุนูู ูู ุงููุฌูุฏ
โ ุชุญูู ูู ุญุฐู ุงูุณุฌู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
```

### 4. ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ:
```
โ ุฃูุดุฆ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุน ุงูุตูุฑ
โ ุงุญุฐู ุจุนุถ ุงูุตูุฑ
โ ุงุณุชุนุฏ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ
โ ุชุญูู ูู ุงุณุชุนุงุฏุฉ ุงูุตูุฑ ุจุดูู ุตุญูุญ
```

## ุงููุณุงุฑุงุช ุงููุฏุนููุฉ:

### ููุญูุธ:
- `userData/dental_images/` (ุงููุณุงุฑ ุงูุฃุณุงุณู)
- `public/upload/dental_images/` (ูุณุงุฑ ุงุญุชูุงุทู)

### ูููุฑุงุกุฉ:
- `userData/dental_images/`
- `public/upload/dental_images/`
- ุงููุณุงุฑุงุช ุงููุทููุฉ

## ุฃููุงุน ุงูุตูุฑ ุงููุฏุนููุฉ:
- `before` - ุตูุฑ ูุจู ุงูุนูุงุฌ
- `after` - ุตูุฑ ุจุนุฏ ุงูุนูุงุฌ
- `xray` - ุตูุฑ ุงูุฃุดุนุฉ
- `clinical` - ุตูุฑ ุณุฑูุฑูุฉ
- `other` - ุฃููุงุน ุฃุฎุฑู

## ููุงุญุธุงุช ูููุฉ:

1. **ุงูุชูุงูู ูุน ุงููุณุฎุฉ ุงููุฏููุฉ**: ุงููุธุงู ูุฏุนู ุงูุตูุฑ ุงููุญููุธุฉ ุจุงูุทุฑููุฉ ุงููุฏููุฉ
2. **ุฃูุงู ุงูุญุฐู**: ุญุฐู ุงูุตูุฑ ูุชู ุจุญุฐุฑ ูุน ุงูุชุญูู ูู ูุฌูุฏ ุงูููู
3. **ูุฑููุฉ ุงููุณุงุฑุงุช**: ุงููุธุงู ูุจุญุซ ูู ูุณุงุฑุงุช ูุชุนุฏุฏุฉ ููุนุซูุฑ ุนูู ุงูุตูุฑ
4. **ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ**: ุชุฏุนู ุงูุตูุฑ ูุงูุจูุงูุงุช ูุนุงู

## ุงูุชุญุฏูุซุงุช ุงูุฅุถุงููุฉ (ุงูุฅุตุฏุงุฑ 2):

### ๐ง ุชุญุณูู ุญุฐู ุงูุตูุฑ:
- **ุฅุถุงูุฉ ุชูุงุตูู ุฃูุซุฑ ููุชุดุฎูุต**: ุชู ุฅุถุงูุฉ console.log ููุตู ูุชุชุจุน ุนูููุฉ ุญุฐู ุงูุตูุฑ
- **ุงูุจุญุซ ูู ูุณุงุฑุงุช ูุชุนุฏุฏุฉ**: ูุจุญุซ ุงููุธุงู ูู 3 ูุณุงุฑุงุช ูุฎุชููุฉ ููุนุซูุฑ ุนูู ุงูููู
- **ุชูุงุฑูุฑ ููุตูุฉ**: ูุนุฑุถ ุงููุณุงุฑุงุช ุงูุชู ุชู ูุญุตูุง ูุณุจุจ ูุดู ุงูุญุฐู ุฅู ูุฌุฏ

### ๐ ุชุญุณูู ุงุณุชุนุงุฏุฉ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ:
- **ุชูุงุตูู ุฃูุซุฑ ูู updateImagePathsAfterRestore**: ุฅุถุงูุฉ console.log ููุตู ูุชุชุจุน ุนูููุฉ ุงุณุชุนุงุฏุฉ ุงูุตูุฑ
- **ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุฑ**: ุชู ุฅุถุงูุฉ ุฏุงูุฉ `refreshAllImages` ูุฅุนุงุฏุฉ ุชุญููู ุฌููุน ุงูุตูุฑ ุจุนุฏ ุงูุงุณุชุนุงุฏุฉ
- **ุชุญุฏูุซ ูุงุฌูุฉ ุงููุณุชุฎุฏู**: ุงูุตูุฑ ุชุธูุฑ ููุฑุงู ุจุนุฏ ุงุณุชุนุงุฏุฉ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ

### ๐ฑ ุชุญุณูู ูุงุฌูุฉ ุงููุณุชุฎุฏู:
- **ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุฑ ุจุนุฏ ุงูุญุฐู**: ุนูุฏ ุญุฐู ุตูุฑุฉุ ูุชู ุฅุนุงุฏุฉ ุชุญููู ูุงุฆูุฉ ุงูุตูุฑ ููุฑุงู
- **ุชุญุฏูุซ Store**: ุฅุถุงูุฉ ุฏุงูุฉ `refreshAllImages` ูู dentalTreatmentStore
- **ุชุญุฏูุซ ุตูุญุงุช ุงูุงุณุชุนุงุฏุฉ**: ุฌููุน ุตูุญุงุช ุงุณุชุนุงุฏุฉ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ุชุณุชุฏุนู refreshAllImages

## ูุณุงุฑุงุช ุงูุจุญุซ ุนู ุงูุตูุฑ:

### ุนูุฏ ุงูุญุฐู:
1. `userData/dental_images/...` (ุงููุณุงุฑ ุงูุฃุณุงุณู)
2. `public/upload/dental_images/...` (ุงููุณุงุฑ ุงูุงุญุชูุงุทู)
3. ุงููุณุงุฑ ุงููุทูู ุฅุฐุง ูุงู ูุชุงุญุงู

### ุนูุฏ ุงููุฑุงุกุฉ:
1. `userData/dental_images/...`
2. `public/upload/dental_images/...`
3. ุงููุณุงุฑ ุงููุณุจู ูู ุฌุฐุฑ ุงููุดุฑูุน
4. ุงููุณุงุฑ ุงููุฏูู ููุชูุงูู ูุน ุงููุณุฎุฉ ุงูุณุงุจูุฉ

## ุฑุณุงุฆู ุงูุชุดุฎูุต ุงูุฌุฏูุฏุฉ:

### ุนูุฏ ุญุฐู ุงูุตูุฑ:
```
๐ Image record to delete: {record details}
๐ Attempting to delete image file: {path}
โ Physical image file deleted from userData: {path}
โ File not found at userData path: {path}
โ๏ธ Physical image file not found at any location: {path}
```

### ุนูุฏ ุงุณุชุนุงุฏุฉ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ:
```
๐ Processing image record: {record}
๐ค Patient info: {patient}
๐งน Clean patient name: {cleanName}
๐ฏ Expected path: {expectedPath}
โ File found at expected location
๐ Found and updated image path: {id} -> {newPath}
๐ All files in dental_images: {filesList}
```

## ุงูุฎุทูุงุช ุงูุชุงููุฉ:

1. **ุงุฎุชุจุงุฑ ุญุฐู ุงูุตูุฑ**:
   - ุฃุถู ุตูุฑุฉ ูุณู
   - ุงุญุฐู ุงูุตูุฑุฉ
   - ุชุญูู ูู ุงูู console ููุฑุณุงุฆู ุงูุชุดุฎูุตูุฉ
   - ุชุฃูุฏ ูู ุญุฐู ุงูููู ุงููุนูู

2. **ุงุฎุชุจุงุฑ ุงุณุชุนุงุฏุฉ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ**:
   - ุฃูุดุฆ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุน ุตูุฑ
   - ุงุญุฐู ุจุนุถ ุงูุตูุฑ
   - ุงุณุชุนุฏ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ
   - ุชุญูู ูู ุงูู console ููุฑุณุงุฆู ุงูุชุดุฎูุตูุฉ
   - ุชุฃูุฏ ูู ุธููุฑ ุงูุตูุฑ ููุฑุงู

3. **ูุฑุงูุจุฉ ุงูุฃุฏุงุก**:
   - ุชุญูู ูู ุณุฑุนุฉ ุญุฐู ุงูุตูุฑ
   - ุชุญูู ูู ุณุฑุนุฉ ุงุณุชุนุงุฏุฉ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ
   - ุฑุงูุจ ุงุณุชููุงู ุงูุฐุงูุฑุฉ

4. **ุงุฎุชุจุงุฑ ุงูุญุงูุงุช ุงูุญุฏูุฉ**:
   - ุตูุฑ ุจุฃุณูุงุก ุนุฑุจูุฉ
   - ุตูุฑ ุจูุณุงุฑุงุช ุทูููุฉ
   - ุตูุฑ ูู ูุฌูุฏุงุช ูุชุนุฏุฏุฉ ุงููุณุชููุงุช
